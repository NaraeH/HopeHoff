<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="hopeHoff.dao.ReservationDao">
	 
	 <resultMap type="Reservation" id="reservationMap">
    	<!-- PK 컬럼은 id 태그를 사용하여 지정한다. -->
    	<id column="RNO" property="reservationNo"/>
   		<result column="UPHONE" property="userPhone"/>
   		<result column="RDATE" property="reservationDate"/>
   		<result column="RSTATUS" property="reservationStatus"/>
  	</resultMap>
  	
  	 <resultMap type="reservationListItem" id="reservationListItemMap">
	    <!-- PK 컬럼은 id 태그를 사용하여 지정한다. -->
	    <id column="RNO" property="reservationNo"/>
	    <result column="UPHONE" property="userPhone"/>
	    <result column="RDATE" property="reservationDate"/>
	    <result column="RSTATUS" property="reservationStatus"/>
    </resultMap>
    
    <select id="selectList" parameterType="map" 
        resultMap="reservationListItemMap">
    SELECT 
		  T1.RNO, 
		  T2.UPHONE, 
		  T1.RDATE, 
		  T1.RSTATUS
		FROM RESERVATION T1 LEFT OUTER JOIN USER T2 
		USING(UID)
		ORDER BY T1.RNO
    <if test="pageSize > 0">
      limit #{startIndex}, #{pageSize}
    </if>
  </select>
  
	  <select id="selectOne" parameterType="int" resultMap="reservationMap">
	  	  SELECT RNO,UPHONE,RDATE,RSTATUS
	  	  WHERE RNO=#{value}
	  </select>
  
	   <select id="totalSize" resultType="int">
	   	 SELECT count(RNO) FROM RESERVATION
	  </select>
	  
<!-- 	  <insert id="insert" parameterType="Reservation"
	   	  useGeneratedKeys="true" keyColumn="RNO" keyProperty="reservationNo">
	   	  INSERT INTO RESERVATION(RDATE,RCONTENT,UID,RSTATUS) 
	   	  VALUES (#{reservationDate},#{reservationContent},#{userId},#{reservationStatus})
	  </insert> -->
  
   	  <delete id="delete" parameterType="int">
         DELETE FROM RESERVATION WHERE PNO=#{value}
  	  </delete>

	
</mapper>